

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>[RTL8722CSM] [RTL8722DM] Use MQTT over TLS &mdash; amebaDocs 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="[RTL8722CSM] [RTL8722DM] Ameba AP Mode" href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Ameba%20AP%20Mode.html" />
    <link rel="prev" title="[RTL8722CSM] [RTL8722DM] Use Amazon AWS IoT Shadow Service" href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Use%20Amazon%20AWS%20IoT%20Shadow%20Service.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> amebaDocs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Open Source SDKs:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../source/arduino_index.html">Arduino SDK</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html">AmebaD</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../ambd_mini/source/index.html">AmebaD-mini</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/getting_started/RTL8722DM_mini_Arduino%20SDK_getting%20start.html">Getting Started with RTL8722DM_mini</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/download/index.html">Download</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../ambd_mini/source/peripherals_and_examples/index.html">Peripherals &amp; Examples</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../ambd_mini/source/peripherals_and_examples/RTL8722DM_MINI_Arduino_SDK_basic_example_table%2015Apr2021.html">Basic Examples</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="Network%20Examples.html">Network Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Peripheral%20Examples.html">Peripheral Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Components%20used.html">Components used</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/board_hdk/index.html">Board HDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/api_documents/index.html">API Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/resources/index.html">Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/support/index.html">Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_micropython/source/index.html">Micropython SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_sdk/source/index.html">Standard SDK</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">amebaDocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../source/arduino_index.html">Arduino SDK</a> &raquo;</li>
        
          <li><a href="../index.html">AmebaD</a> &raquo;</li>
        
          <li><a href="index.html">Peripherals &amp; Examples</a> &raquo;</li>
        
          <li><a href="Network%20Examples.html">Network Examples</a> &raquo;</li>
        
      <li>[RTL8722CSM] [RTL8722DM] Use MQTT over TLS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/ambd_arduino/source/peripherals_and_examples/[RTL8722CSM] [RTL8722DM] Use MQTT over TLS.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rtl8722csm-rtl8722dm-use-mqtt-over-tls">
<h1>[RTL8722CSM] [RTL8722DM] Use MQTT over TLS<a class="headerlink" href="#rtl8722csm-rtl8722dm-use-mqtt-over-tls" title="Permalink to this headline">¶</a></h1>
<p>Preparation</p>
<ul class="simple">
<li><p>Ameba x 1</p></li>
</ul>
<p>Example</p>
<p>In this example, we connect Ameba to a MQTT broker using TLS
authentication. Then send messages as a publisher and receive messages
from as a subscriber. Open the MQTT example “File” -&gt; “Examples” -&gt;
“AmebaMQTTClient” -&gt; “MQTT_TLS”<a class="reference internal" href="../../../_images/image166.png"><img alt="2" src="../../../_images/image166.png" style="width: 6.02778in; height: 3.45833in;" /></a>Please modify the WiFi-related
parameters to connect to your WiFi network. Modify the MQTT parameters
to fit your application:<a class="reference internal" href="../../../_images/image262.png"><img alt="image1" src="../../../_images/image262.png" style="width: 6.02778in; height: 3.45833in;" /></a>The “mqttServer” refers to the
MQTT-Broker, we use the free MQTT sandbox “test.mosquitto.org” for
testing. “clientId” is an identifier for MQTT-Broker to identify the
connected device. “publishTopic” is the topic of the published message,
we use “outTopic” in the example. The devices subscribe to “outTopic”
will receive the message. “publishPayload” is the content to be
published. “subscribeTopic” is to tell MQTT-broker which topic we want
to subscribe to. Next, compile the code and upload it to Ameba. Press
the reset button, then open the serial monitor<a class="reference internal" href="../../../_images/image341.png"><img alt="3" src="../../../_images/image341.png" style="width: 6.02778in; height: 6.02778in;" /></a>After Ameba is
connected to MQTT server, it sends the message “hello world” to
“outTopic”. To see the message, use another MQTT client. Refer to the
MQTT_Basic example guide on how to setup a PC-based MQTT client. If you
wish to use TLS client authentication in addition to server
authentication, you will need to generate an OpenSSL private key and
obtain a signed certificate from the server. For testing purposes,
signed certificates can be obtained from test.mosquitto.org by following
the guide at <a class="reference external" href="https://test.mosquitto.org/ssl/">https://test.mosquitto.org/ssl/</a>. Replace the character
strings “certificateBuff” and “privateKeyBuff” with your signed
certificate and OpenSSL private key, ensuring that they are formatted
the same way as the shown in the example code. Also uncomment the
highlighted code to enable client authentication, and to change the MQTT
port number.<a class="reference internal" href="../../../_images/image435.png"><img alt="image2" src="../../../_images/image435.png" style="width: 6.02778in; height: 6.02778in;" /></a><a class="reference internal" href="../../../_images/image520.png"><img alt="image3" src="../../../_images/image520.png" style="width: 6.02778in; height: 6.02778in;" /></a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Ameba%20AP%20Mode.html" class="btn btn-neutral float-right" title="[RTL8722CSM] [RTL8722DM] Ameba AP Mode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Use%20Amazon%20AWS%20IoT%20Shadow%20Service.html" class="btn btn-neutral float-left" title="[RTL8722CSM] [RTL8722DM] Use Amazon AWS IoT Shadow Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ameba IoT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>