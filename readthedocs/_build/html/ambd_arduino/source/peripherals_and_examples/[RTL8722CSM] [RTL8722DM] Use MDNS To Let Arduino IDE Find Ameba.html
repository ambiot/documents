

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>[RTL8722CSM] [RTL8722DM] Use MDNS To Let Arduino IDE Find Ameba &mdash; amebaDocs 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="[RTL8722CSM] [RTL8722DM] Use Firebase To Push Messaging Services" href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Use%20Firebase%20To%20Push%20Messaging%20Services.html" />
    <link rel="prev" title="[RTL8722CSM] [RTL8722DM] Ameba AP Mode" href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Ameba%20AP%20Mode.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> amebaDocs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Open Source SDKs:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../source/arduino_index.html">Arduino SDK</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html">AmebaD</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../ambd_mini/source/index.html">AmebaD-mini</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/getting_started/RTL8722DM_mini_Arduino%20SDK_getting%20start.html">Getting Started with RTL8722DM_mini</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/download/index.html">Download</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../ambd_mini/source/peripherals_and_examples/index.html">Peripherals &amp; Examples</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../ambd_mini/source/peripherals_and_examples/RTL8722DM_MINI_Arduino_SDK_basic_example_table%2015Apr2021.html">Basic Examples</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="Network%20Examples.html">Network Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Peripheral%20Examples.html">Peripheral Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="Components%20used.html">Components used</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/board_hdk/index.html">Board HDK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/api_documents/index.html">API Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/resources/index.html">Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ambd_mini/source/support/index.html">Support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_micropython/source/index.html">Micropython SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ambd_sdk/source/index.html">Standard SDK</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">amebaDocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../source/arduino_index.html">Arduino SDK</a> &raquo;</li>
        
          <li><a href="../index.html">AmebaD</a> &raquo;</li>
        
          <li><a href="index.html">Peripherals &amp; Examples</a> &raquo;</li>
        
          <li><a href="Network%20Examples.html">Network Examples</a> &raquo;</li>
        
      <li>[RTL8722CSM] [RTL8722DM] Use MDNS To Let Arduino IDE Find Ameba</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/ambd_arduino/source/peripherals_and_examples/[RTL8722CSM] [RTL8722DM] Use MDNS To Let Arduino IDE Find Ameba.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rtl8722csm-rtl8722dm-use-mdns-to-let-arduino-ide-find-ameba">
<h1>[RTL8722CSM] [RTL8722DM] Use MDNS To Let Arduino IDE Find Ameba<a class="headerlink" href="#rtl8722csm-rtl8722dm-use-mdns-to-let-arduino-ide-find-ameba" title="Permalink to this headline">¶</a></h1>
<p>Preparation</p>
<ul class="simple">
<li><p>Ameba x 1</p></li>
</ul>
<p>Example</p>
<p>mDNS (Multicast DNS) is a protocol used in the local area network. It
delivers the network information like IP address and provided services
to others. mDNS is based on the UDP protocol, and it sends packets to
224.0.0.251 with port 5353 under IPv4 address. The naming style for the
service follows the format: <strong>{Instance Name}.{Protocol Name}.{Domain}</strong></p>
<ul class="simple">
<li><p>Instance Name: used to identify the name of the service</p></li>
<li><dl class="simple">
<dt>Protocol Name: Divided into two parts, the front end is in regard to</dt><dd><p>the name of the service, and it adds baseline as a prefix. The
rear end is in regard to the transport protocol name it used, and
it also adds baseline as a prefix</p>
</dd>
</dl>
</li>
<li><p>Domain: Local area network in normal cases</p></li>
</ul>
<p>For example, Arduino IDE adopts the naming for the mDNS service which is
used in OTA as following: <strong>MyAmeba._arduino._tcp.local</strong> Among the
naming example, “MyAmeba” can identify the Ameba device name and the
name “MyAmeba” is changeable. “_arduino._tcp” is the protocol that
Arduino IDE adopts, and the Domain is set as local in common. Open the
example, “File” -&gt; “Examples” -&gt; “AmebaMDNS” -&gt; “mdns_on_arduino_ide”
You need to input ssid and password of the AP because the example will
use WiFi connection. And you can find out the naming of the service at
the place where it declares MDNS Service. The example uses the default
name “MyAmeba” and the name is changeable.<a class="reference internal" href="../../../_images/image164.png"><img alt="1" src="../../../_images/image164.png" style="width: 5.20833in; height: 3.04861in;" /></a>Next, go to (“Tools” -&gt;
“Port”), and you can find out at least one Serial Port. This port is
simulated by Ameba board via USB. Choose this port and upload the
compiled code to Ameba.<a class="reference internal" href="../../../_images/image259.png"><img alt="2" src="../../../_images/image259.png" style="width: 5.47917in; height: 6.52083in;" /></a>After uploading the code, press the reset
button on Ameba and waiting for Ameba to connect with AP and activate
the mDNS service after a while. You can see the Log at the bottom of the
Serial Monitor.<a class="reference internal" href="../../../_images/image339.png"><img alt="3" src="../../../_images/image339.png" style="width: 6.5in; height: 2.37847in;" /></a>Then you can find out the added item “Network
Ports” <strong>“MyAmeba at 192.168.1.167 (Ameba RTL8722DM/RTL8722CSM)”</strong>,
“MyAmeba” is the device name we set up, and “IP” is the IP address that
AP assigned to Ameba, the IP address should be the same with the IP
shown in the Serial Monitor. Last, “Ameba RTL8722DM/RTL8722CSM” is the
type name of the board, and it means that Ameba can let Arduino IDE
identify the mDNS service successfully.(We still can not use the
Internet to upload the code, and we will explain this part in the OTA
example.)<a class="reference internal" href="../../../_images/image433.png"><img alt="4" src="../../../_images/image433.png" style="width: 6.5in; height: 5.55417in;" /></a>If you cannot find the Network ports on your Arduino
IDE, please check：</p>
<ul class="simple">
<li><p>Does your computer in the same local area network with the Ameba?</p></li>
<li><p>Restart the Arduino IDE, and it will find the mDNS service again</p></li>
<li><dl class="simple">
<dt>Check the Log in Serial Monitor if the Ameba connects to the AP and</dt><dd><p>activate mDNS service successfully</p>
</dd>
</dl>
</li>
</ul>
<p>Code Reference</p>
<p>The program set up the mDNS service in the beginning, the first
parameter is Instance Name, and it is changeable in this example. The
second parameter is the protocol that the service used, and it would be
“_arduino._tcp” for Arduino IDE. The third parameter is Domain, and it
would be “local” in common. The fourth parameter is the port number for
the service, it is 5000 here and we doesn’t use it in the example.</p>
<p>MDNSService service(“MyAmeba”, “_arduino._tcp”, “local”, 5000);</p>
<p>After connected to the network, we set up some text fields for the
service. For the following example, “board” is the name of the field,
“ameba_rtl8721d” is the value of the field. “board” is used to let
Arduino IDE check installed SDK to see if it exists known device or not.
We will use the name of the device if there is known device, users can
change “ameba_rtl8721d” to “yun” or other names to find out what’s the
difference if interested.</p>
<p>service.addTxtRecord(“board”, strlen(“ameba_rtl8721d”),
“ameba_rtl8721d”);</p>
<p>Then we add three text fields “auth_upload”, “tcp_check”, and
“ssh_upload”, this example does not activate these services.</p>
<p>service.addTxtRecord(“auth_upload”, strlen(“no”), “no”);</p>
<p>service.addTxtRecord(“tcp_check”, strlen(“no”), “no”);</p>
<p>service.addTxtRecord(“ssh_upload”, strlen(“no”), “no”);</p>
<p>Next we activate MDNS</p>
<p>MDNS.begin();</p>
<p>and register to the mDNS service.</p>
<p>MDNS.registerService(service);</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Use%20Firebase%20To%20Push%20Messaging%20Services.html" class="btn btn-neutral float-right" title="[RTL8722CSM] [RTL8722DM] Use Firebase To Push Messaging Services" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="%5BRTL8722CSM%5D%20%5BRTL8722DM%5D%20Ameba%20AP%20Mode.html" class="btn btn-neutral float-left" title="[RTL8722CSM] [RTL8722DM] Ameba AP Mode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ameba IoT.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>